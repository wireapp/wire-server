Fix a bug in the IdP.Mem interpreter, and added law tests for IdP
