Improve the `Qualified` abstraction and make local/remote tagging safer
