<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Authentication &mdash; Wire 0.0.4 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/wire.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Swagger API documentation" href="swagger.html" />
    <link rel="prev" title="Wire-server API documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    <a href="../../index.html">
        <img src="../../_static/Wire_logo.svg" class="logo" alt="Logo"/>
    </a>

    <!--
            <div class="version">
                0.0.4
            </div> -->
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../security-responses/index.html">Security responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/administrate/index.html">Administration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../single-sign-on/index.html">Single Sign-On and User Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restund.html">Audio/video calling, restund servers (TURN/STUN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sft.html">Conference Calling 2.0 (aka SFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sft.html#federated-conference-calling">Federated Conference Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../minio.html">Minio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helm.html">Helm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../federation/index.html">Federation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../associate/index.html">Connecting Wire Clients</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Client API documentation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#access-tokens">Access Tokens</a></li>
<li class="toctree-l4"><a class="reference internal" href="#login-post-login">Login - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/login</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#token-refresh-post-access">Token Refresh - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/access</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie-management">Cookie Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#password-reset-post-password-reset">Password Reset - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/password-reset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-topics-sso-legalhold">Related topics: SSO, Legalhold</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="swagger.html">Swagger API documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../crypto-libs.html">Crypto libraries and sources of randomness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../block-user-creation.html">Block personal user creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../classified-domains.html">Classified Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configure-federation.html">Federation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../legalhold.html">Installing and setting up Legal Hold</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mls.html">Messaging Layer Security (MLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../searchability.html">User Searchability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../team-feature-settings.html">Server and team feature settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developers Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Wire</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="index.html">Wire-server API documentation</a></li>
      <li class="breadcrumb-item active">Authentication</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/wireapp/wire-server/blob/develop/docs/src/understand/api-client-perspective/authentication.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="authentication">
<h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this heading"></a></h1>
<section id="access-tokens">
<h2>Access Tokens<a class="headerlink" href="#access-tokens" title="Permalink to this heading"></a></h2>
<p>The authentication protocol used by the API is loosely inspired by the
<a class="reference external" href="http://oauth.net/2/">OAuth2 protocol</a>. As such, API requests are
authorised through so-called <a class="reference external" href="https://tools.ietf.org/html/rfc6750">bearer
tokens</a>. For as long as a bearer
token is valid, it grants access to the API under the identity of the
user whose credentials have been used for the [login]. The
current validity of access tokens is <code class="docutils literal notranslate"><span class="pre">15</span> <span class="pre">minutes</span></code>, however, that may
change at any time without prior notice.</p>
<p>In order to obtain new access tokens without having to ask the user for
his credentials again, so-called “user tokens” are issued which are
issued in the form of a <code class="docutils literal notranslate"><span class="pre">zuid</span></code> HTTP
<a class="reference external" href="https://en.wikipedia.org/wiki/HTTP_cookie">cookie</a>. These cookies
have a long lifetime (if <a class="reference internal" href="#login-persistent"><span class="std std-ref">persistent</span></a> typically
at least a few months) and their use is strictly limited to the
<a class="reference internal" href="#token-refresh"><span class="std std-ref">/access</span></a> endpoint used for token refresh.
<a class="reference internal" href="#login-persistent"><span class="std std-ref">Persistent</span></a> access cookies are regularly
refreshed as part of an <a class="reference internal" href="#token-refresh"><span class="std std-ref">access token refresh</span></a>.</p>
<p>An access cookie is obtained either directly after registration or through a
subsequent <a class="reference internal" href="#login"><span class="std std-ref">login</span></a>. A successful login provides both an access
cookie and and access token. Both access token and cookie must be stored safely
and kept confidential. User passwords should not be stored.</p>
<p>As of yet, there is no concept of authorising third-party applications to
perform operations on the API on behalf of a user (Notable exceptions:
<a class="reference internal" href="#sso"><span class="std std-ref">Single Sign-On</span></a>). Such functionality may be provided in the future through
standardised OAuth2 flows.</p>
<p>To authorise an API request, the access token must be provided via the
HTTP <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> header with the <code class="docutils literal notranslate"><span class="pre">Bearer</span></code> scheme as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="n">fmmLpDSjArpksFv57r5rDrzZZlj</span><span class="o">...</span>
</pre></div>
</div>
<p>While the API currently also supports passing the access token in the
query string of a request, this approach is highly discouraged as it
unnecessarily exposes access tokens (e.g. in server logs) and thus might
be removed in the future.</p>
</section>
<section id="login-post-login">
<span id="login"></span><h2>Login - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/login</span></code><a class="headerlink" href="#login-post-login" title="Permalink to this heading"></a></h2>
<p>A login is the process of authenticating a user either through a known secret in
a <a class="reference internal" href="#login-password"><span class="std std-ref">password login</span></a> or by proving ownership of a verified
phone number associated with an account in an <a class="reference internal" href="#login-sms"><span class="std std-ref">SMS login</span></a>. The
response to a successful login contains an access cookie in a <code class="docutils literal notranslate"><span class="pre">Set-Cookie</span></code>
header and an access token in the JSON response body.</p>
<section id="cookies">
<span id="login-cookies"></span><h3>Cookies<a class="headerlink" href="#cookies" title="Permalink to this heading"></a></h3>
<p>There is a hard limit for the number of session-scoped access cookies and the same
amount of persistent access cookies per user account. When this number is
reached, old cookies are removed when new ones are issued. Thereby, the cookies
with the oldest expiration timestamp are removed first. The removal takes the
type of the cookie to issue into account. I.e. session cookies are replaced by
session cookies, persistent cookies are replaced by persistent cookies.</p>
<p>To prevent performance issues and malicious usages of the API, there is a
throttling mechanism in place. When the maximum number of cookies of one type
are issued, it’s checked that login calls don’t happen too frequently (too
quickly after one another.)</p>
<p>In case of throttling no cookie gets issued. The error response (<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429">HTTP status
code 429</a>) has
a <code class="docutils literal notranslate"><span class="pre">Retry-After</span></code> header which specifies the time to wait before accepting the
next request in Seconds.</p>
<p>Being throttled is a clear indicator of incorrect API usage. There is no need to
login many times in a row on the same device. Instead, the cookie should be
re-used.</p>
<p>The corresponding backend configuration settings are described in:
<a class="reference internal" href="../../how-to/install/infrastructure-configuration.html#auth-cookie-config"><span class="std std-ref">Configuring authentication cookie throttling</span></a> .</p>
</section>
<section id="password-login">
<span id="login-password"></span><h3>Password Login<a class="headerlink" href="#password-login" title="Permalink to this heading"></a></h3>
<p>To perform a password login, send a <code class="docutils literal notranslate"><span class="pre">POST</span></code> request to the <code class="docutils literal notranslate"><span class="pre">/login</span></code>
endpoint, providing either a verified email address or phone number and
the corresponding password. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">login</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;me@wire.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;Quo2Booz&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If a phone number is used, the <code class="docutils literal notranslate"><span class="pre">phone</span></code> field is used instead of
<code class="docutils literal notranslate"><span class="pre">email</span></code>. If a &#64;handle is used, the <code class="docutils literal notranslate"><span class="pre">handle</span></code> field is used instead of
<code class="docutils literal notranslate"><span class="pre">email</span></code> (note that the handle value should be sent <em>without</em> the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>
symbol). Assuming the credentials are correct, the API will respond with
a <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> and an access token and cookie:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="n">zuid</span><span class="o">=...</span><span class="p">;</span> <span class="n">Expires</span><span class="o">=</span><span class="n">Fri</span><span class="p">,</span> <span class="mi">02</span><span class="o">-</span><span class="n">Aug</span><span class="o">-</span><span class="mi">2024</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">54</span> <span class="n">GMT</span><span class="p">;</span> <span class="n">Domain</span><span class="o">=</span><span class="n">zinfra</span><span class="o">.</span><span class="n">io</span><span class="p">;</span> <span class="n">Path</span><span class="o">=/</span><span class="n">access</span><span class="p">;</span> <span class="n">HttpOnly</span><span class="p">;</span> <span class="n">Secure</span>
<span class="p">[</span><span class="n">other</span> <span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;expires_in&quot;</span><span class="p">:</span> <span class="mi">900</span><span class="p">,</span>
    <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="s2">&quot;fmmLpDSjArpksFv57r5rDrzZZlj...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;token_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">Domain</span></code> of the cookie will be different depending on the
environment.</p>
</div></blockquote>
<p>The value of <code class="docutils literal notranslate"><span class="pre">expires_in</span></code> is the number of seconds that the
<code class="docutils literal notranslate"><span class="pre">access_token</span></code> is valid from the moment it was issued.</p>
<p>As of yet, the <code class="docutils literal notranslate"><span class="pre">token_type</span></code> is always <code class="docutils literal notranslate"><span class="pre">Bearer</span></code>.</p>
</section>
<section id="sms-login">
<span id="login-sms"></span><h3>SMS Login<a class="headerlink" href="#sms-login" title="Permalink to this heading"></a></h3>
<p>To perform an SMS login, first request an SMS code to be sent to a
verified phone number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="n">send</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1234567890&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An SMS with a short-lived login code will be sent. Upon receiving the
SMS and extracting the code from it, the login can be performed using
the <code class="docutils literal notranslate"><span class="pre">phone</span></code> and <code class="docutils literal notranslate"><span class="pre">code</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">login</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1234567890&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A successful response is identical to that of a <a class="reference internal" href="#login-password"><span class="std std-ref">password login</span></a>.</p>
</section>
<section id="persistent-logins">
<span id="login-persistent"></span><h3>Persistent Logins<a class="headerlink" href="#persistent-logins" title="Permalink to this heading"></a></h3>
<p>By default, access cookies are issued as <a class="reference external" href="https://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie">session
cookies</a>
with a validity of 1 week. Furthermore, these session cookies are not
refreshed as part of an <a class="reference internal" href="#token-refresh"><span class="std std-ref">access token refresh</span></a>. To
request a <code class="docutils literal notranslate"><span class="pre">persistent</span></code> access cookie which does get refreshed, specify
the <code class="docutils literal notranslate"><span class="pre">persist=true</span></code> parameter during a login:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /login?persist=true HTTP/1.1
[headers omitted]

{
    &quot;phone&quot;: &quot;+1234567890&quot;,
    &quot;code&quot;: &quot;123456&quot;
}
</pre></div>
</div>
<p>All access cookies returned on registration are persistent.</p>
</section>
<section id="faq-is-my-cookie-a-persistent-cookie-or-a-session-cookie">
<span id="token-refresh"></span><h3>FAQ: is my cookie a persistent cookie or a session cookie?<a class="headerlink" href="#faq-is-my-cookie-a-persistent-cookie-or-a-session-cookie" title="Permalink to this heading"></a></h3>
<p>When you log in <strong>without</strong> the <code class="docutils literal notranslate"><span class="pre">persist=true</span></code> query parameter, or
with persist=false, you get a <code class="docutils literal notranslate"><span class="pre">session</span> <span class="pre">cookie</span></code>, which means it has no
expiration date set, and will expire when you close the browser (and on
the backend has a validity of max 1 day or 1 week (configurable, see
current config in <a class="reference external" href="https://github.com/zinfra/hegemony">hegemony</a>).
Example <strong>session cookie</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /login?persist=false

Set-Cookie: zuid=(redacted); Path=/access; Domain=zinfra.io; HttpOnly; Secure
</pre></div>
</div>
<p>When you log in <strong>with</strong> <code class="docutils literal notranslate"><span class="pre">persist=true</span></code>, you get a persistent cookie,
which means it has <em>some</em> expiration date. In production this is
currently 56 days (again, configurable, check current config in
<a class="reference external" href="https://github.com/zinfra/hegemony">hegemony</a>) and can be renewed
during token refresh. Example <strong>persistent cookie</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /login?persist=true

Set-Cookie: zuid=(redacted); Path=/access; Expires=Thu, 10-Jan-2019 10:43:28 GMT; Domain=zinfra.io; HttpOnly; Secure
</pre></div>
</div>
</section>
</section>
<section id="token-refresh-post-access">
<h2>Token Refresh - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/access</span></code><a class="headerlink" href="#token-refresh-post-access" title="Permalink to this heading"></a></h2>
<p>Since access tokens have a relatively short lifetime to limit the time
window of abuse for a captured token, they need to be regularly
refreshed. In order to refresh an access token, send a <code class="docutils literal notranslate"><span class="pre">POST</span></code> reques
to <code class="docutils literal notranslate"><span class="pre">/access</span></code>, including the access cookie in the <code class="docutils literal notranslate"><span class="pre">Cookie</span></code> header and
the old (possibly expired) access token in the <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">access</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="n">fmmLpDSjArpksFv57r5rDrzZZlj</span><span class="o">...</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">zuid</span><span class="o">=...</span>
<span class="p">[</span><span class="n">other</span> <span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="o">&lt;</span><span class="n">empty</span> <span class="n">body</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Providing the old access token is not required but strongly recommended
as it will link the new access token to the old, enabling the API to see
the new access token as a continued session of the same client.</p>
<p>As part of an access token refresh, the response may also contain a new
<code class="docutils literal notranslate"><span class="pre">zuid</span></code> access cookie in form of a <code class="docutils literal notranslate"><span class="pre">Set-Cookie</span></code> header. A client must
expect a new <code class="docutils literal notranslate"><span class="pre">zuid</span></code> cookie as part of any access token refresh and
replace the existing cookie appropriately.</p>
</section>
<section id="cookie-management">
<span id="cookies-1"></span><h2>Cookie Management<a class="headerlink" href="#cookie-management" title="Permalink to this heading"></a></h2>
<section id="logout-post-access-logout">
<span id="cookies-logout"></span><h3>Logout - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/access/logout</span></code><a class="headerlink" href="#logout-post-access-logout" title="Permalink to this heading"></a></h3>
<p>An explicit logout effectively deletes the cookie used to perform the
operation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">access</span><span class="o">/</span><span class="n">logout</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="n">fmmLpDSjArpksFv57r5rDrzZZlj</span><span class="o">...</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">zuid</span><span class="o">=...</span>
<span class="p">[</span><span class="n">other</span> <span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="o">&lt;</span><span class="n">empty</span> <span class="n">body</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Afterwards, the cookie that was sent as part of the <code class="docutils literal notranslate"><span class="pre">Cookie</span></code> header is
no longer valid.</p>
<p>If a client offers an explicit logout, this operation must be performed.
An explicit logout is especially important for Web clients.</p>
</section>
<section id="labels">
<span id="cookies-labels"></span><h3>Labels<a class="headerlink" href="#labels" title="Permalink to this heading"></a></h3>
<p>Cookies can be labeled by specifying a <code class="docutils literal notranslate"><span class="pre">label</span></code> during login or
registration, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /login?persist=true HTTP/1.1
[headers omitted]

{
    &quot;phone&quot;: &quot;+1234567890&quot;,
    &quot;code&quot;: &quot;123456&quot;,
    &quot;label&quot;: &quot;Google Nexus 5&quot;
}
</pre></div>
</div>
<p>Specifying a label is recommended as it helps to identify the cookies in a
user-friendly way and allows <a class="reference internal" href="#cookies-revoke"><span class="std std-ref">selective revocation</span></a> based
on the labels.</p>
</section>
<section id="listing-cookies-get-cookies">
<span id="cookies-list"></span><h3>Listing Cookies - <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/cookies</span></code><a class="headerlink" href="#listing-cookies-get-cookies" title="Permalink to this heading"></a></h3>
<p>To list the cookies currently associated with an account, send a <code class="docutils literal notranslate"><span class="pre">GET</span></code>
request to <code class="docutils literal notranslate"><span class="pre">/cookies</span></code>. The response will contain a list of cookies,
e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="p">[</span><span class="n">other</span> <span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
  <span class="s2">&quot;cookies&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-06-04T14:29:23.000Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">967153183</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;session&quot;</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-06-04T14:44:23.000Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">942451749</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;session&quot;</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">},</span>
    <span class="o">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that expired cookies are not automatically removed when they
expire, only as new cookies are issued.</p>
</section>
<section id="revoking-cookies-post-cookies-remove">
<span id="cookies-revoke"></span><h3>Revoking Cookies - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/cookies/remove</span></code><a class="headerlink" href="#revoking-cookies-post-cookies-remove" title="Permalink to this heading"></a></h3>
<p>Cookies can be removed individually or in bulk either by specifying the full
cookie structure as it is returned by <a class="reference internal" href="#cookies-list"><span class="std std-ref">GET /cookies</span></a> or only
by their labels in a <code class="docutils literal notranslate"><span class="pre">POST</span></code> request to <code class="docutils literal notranslate"><span class="pre">/cookies/remove</span></code>, alongside with the
user’s credentials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">cookies</span><span class="o">/</span><span class="n">remove</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="o">&lt;</span><span class="n">cookie1</span><span class="o">&gt;</span><span class="p">},</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">cookie2</span><span class="o">&gt;</span><span class="p">},</span> <span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;label1&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;label2&gt;&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;me@wire.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cookie removal currently requires an account with an email address and
password.</p>
</section>
</section>
<section id="password-reset-post-password-reset">
<span id="password-reset"></span><h2>Password Reset - <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/password-reset</span></code><a class="headerlink" href="#password-reset-post-password-reset" title="Permalink to this heading"></a></h2>
<p>A password reset can be used to set a new password if the existing password
associated with an account has been forgotten. This is not to be confused with
the act of merely changing your password for the purpose of password rotation or
if you suspect your current password to be compromised.</p>
<section id="initiate-a-password-reset">
<h3>Initiate a Password Reset<a class="headerlink" href="#initiate-a-password-reset" title="Permalink to this heading"></a></h3>
<p>To initiate a password reset, send a <code class="docutils literal notranslate"><span class="pre">POST</span></code> request to
<code class="docutils literal notranslate"><span class="pre">/password-reset</span></code>, specifying either a verified email address or phone
number for the account in question:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">password</span><span class="o">-</span><span class="n">reset</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1234567890&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For a phone number, the <code class="docutils literal notranslate"><span class="pre">phone</span></code> field would be used instead. As a
result of a successful request, either a password reset key and code is
sent via email or a password reset code is sent via SMS, depending on
whether an email address or a phone number was provided. Password reset
emails will contain a link to the <a class="reference external" href="https://www.wire.com/">wire.com</a>
website which will guide the user through the completion of the password
reset, which means that the website will perform the necessary requests
to complete the password reset. To complete a password reset initiated
with a phone number, the completion of the password reset has to happen
from the mobile client application itself.</p>
<p>Once a password reset has been initiated for an email address or phone
number, no further password reset can be initiated for the same email
address or phone number before the prior reset is completed or times
out. The current timeout for an initiated password reset is
<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">minutes</span></code>.</p>
</section>
<section id="complete-a-password-reset">
<h3>Complete a Password Reset<a class="headerlink" href="#complete-a-password-reset" title="Permalink to this heading"></a></h3>
<p>To complete a password reset, the password reset code, together with the
new password and the <code class="docutils literal notranslate"><span class="pre">email</span></code> or <code class="docutils literal notranslate"><span class="pre">phone</span></code> used when initiating the
reset (or the opaque <code class="docutils literal notranslate"><span class="pre">key</span></code> sent by mail) are sent to
<code class="docutils literal notranslate"><span class="pre">/password-reset/complete</span></code> in a <code class="docutils literal notranslate"><span class="pre">POST</span></code> request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">password</span><span class="o">-</span><span class="n">reset</span><span class="o">/</span><span class="n">complete</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="p">[</span><span class="n">headers</span> <span class="n">omitted</span><span class="p">]</span>

<span class="p">{</span>
    <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1234567890&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;new-secret-password&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There is a maximum of <code class="docutils literal notranslate"><span class="pre">3</span></code> attempts at completing a password reset,
after which the password reset code becomes invalid and a new password
reset must be initiated.</p>
<p>A completed password reset results in all access cookies to be revoked,
requiring the user to <a class="reference internal" href="#login"><span class="std std-ref">login</span></a>.</p>
</section>
</section>
<section id="related-topics-sso-legalhold">
<h2>Related topics: SSO, Legalhold<a class="headerlink" href="#related-topics-sso-legalhold" title="Permalink to this heading"></a></h2>
<section id="single-sign-on">
<span id="sso"></span><h3>Single Sign-On<a class="headerlink" href="#single-sign-on" title="Permalink to this heading"></a></h3>
<p>Users that are part of a team, for which a team admin has configured SSO (Single Sign On), authentication can happen through SAML.</p>
<p>More information:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../single-sign-on/trouble-shooting.html#trouble-shooting-faq"><span class="std std-ref">FAQ</span></a></p></li>
<li><p><a class="reference external" href="https://docs.wire.com/how-to/single-sign-on/index.html">setup howtos for various IdP vendors</a></p></li>
<li><p><a class="reference external" href="https://github.com/wireapp/wire-server/blob/develop/docs/reference/spar-braindump.md">a few fragments that may help admins</a></p></li>
</ul>
</section>
<section id="legalhold">
<h3>LegalHold<a class="headerlink" href="#legalhold" title="Permalink to this heading"></a></h3>
<p>Users that are part of a team, for which a team admin has configured “LegalHold”, can add a so-called “LegalHold” device. The endpoints in use to authenticate for a “LegalHold” Device are the same as for regular users, but the access tokens they get can only use a restricted set of API endpoints. See also <a class="reference external" href="https://github.com/wireapp/wire-server/blob/develop/docs/reference/team/legalhold.md">legalhold documentation on wire-server</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Wire-server API documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="swagger.html" class="btn btn-neutral float-right" title="Swagger API documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 - 2023, Wire Swiss GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>